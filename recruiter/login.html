<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Recruiter Login</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div data-include="header"></div>

  <main class="auth-page">
    <div class="auth-card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h2 style="margin:0">12failjob.com</h2>
        <span class="pill">RECRUITER</span>
      </div>

      <div class="auth-tabs">
        <button type="button" class="auth-tab active" data-tab="login">Login</button>
        <button type="button" class="auth-tab" data-tab="register">Register</button>
      </div>

      <div id="loginPanel" class="auth-panel active">
        <form id="loginForm">
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="loginEmail" required>
          </div>
          <div class="form-group">
            <label>Password *</label>
            <input type="password" id="loginPassword" required>
          </div>
          <div class="auth-actions">
            <button class="btn btn-primary btn-block">Login</button>
          </div>
        </form>
      </div>

      <div id="registerPanel" class="auth-panel">
        <form id="registerForm">
          <div class="form-group">
            <label>Name / Company *</label>
            <input type="text" id="regName" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="regEmail" required>
          </div>
          <div class="form-group">
            <label>Password *</label>
            <input type="password" id="regPassword" required minlength="6">
          </div>
          <div class="form-group">
            <label>Confirm Password *</label>
            <input type="password" id="regConfirm" required>
          </div>
          <div class="auth-actions">
            <button class="btn btn-primary btn-block">Register</button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <script src="../js/app.js"></script>
<script src="../js/partials.js"></script>

<script>
(function () {

  const existing = getUser();
  if (existing && existing.role === "recruiter") {
    window.location.href = "dashboard.html";
  }

  document.querySelectorAll(".auth-tab").forEach(tab => {
    tab.addEventListener("click", () => {
      document.querySelectorAll(".auth-tab").forEach(x => x.classList.remove("active"));
      document.querySelectorAll(".auth-panel").forEach(p => p.classList.remove("active"));
      tab.classList.add("active");
      document.getElementById(tab.dataset.tab + "Panel").classList.add("active");
    });
  });

  document.getElementById("loginForm")
    .addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = await postJSON("auth_login.php", {
        email: document.getElementById("loginEmail").value.trim(),
        password: document.getElementById("loginPassword").value
      });

      if (!data.ok) return alert(data.message);

      if (data.user.role !== "recruiter") {
        alert("This is Recruiter login page.");
        return;
      }

      setUser(data.user);
      window.location.href = "dashboard.html";
    });

  document.getElementById("registerForm")
    .addEventListener("submit", async (e) => {
      e.preventDefault();

      const pass = document.getElementById("regPassword").value;
      const confirm = document.getElementById("regConfirm").value;

      if (pass !== confirm)
        return alert("Passwords do not match");

      const data = await postJSON("auth_register.php", {
        name: document.getElementById("regName").value.trim(),
        email: document.getElementById("regEmail").value.trim(),
        password: pass,
        role: "recruiter"
      });

      if (!data.ok) return alert(data.message);

      alert("Registered successfully!");
      document.querySelector('[data-tab="login"]').click();
    });

})();
</script>
  <div data-include="footer"></div>
</body>
</html>